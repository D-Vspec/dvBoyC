#include "instructions.h"
#include "flags.h"
#include "memory.h"
#include <stdio.h>

Opcode opcode_table[256];

void init_opcode_table(void) {
    printf("Initializing opcode table...\n");
    opcode_table[0x00] = (Opcode){ nop, 1, 4, "NOP" };
    opcode_table[0x01] = (Opcode){ ld_bc_d16, 3, 12, "LD BC,d16" };
    opcode_table[0x02] = (Opcode){ ld_bc_a, 1, 8, "LD (BC),A" };
    opcode_table[0x03] = (Opcode){ inc_bc, 1, 8, "INC BC" };
    opcode_table[0x04] = (Opcode){ inc_b, 1, 4, "INC B" };
    opcode_table[0x05] = (Opcode){ dec_b, 1, 4, "DEC B" };
    opcode_table[0x06] = (Opcode){ ld_b_d8, 2, 8, "LD B,d8" };
    opcode_table[0x07] = (Opcode){ rlca, 1, 4, "RLCA" };
    opcode_table[0x08] = (Opcode){ ld_a16_sp, 3, 20, "LD (a16),SP" };
    opcode_table[0x09] = (Opcode){ add_hl_bc, 1, 8, "ADD HL,BC" };
    opcode_table[0x0A] = (Opcode){ ld_a_bc, 1, 8, "LD A,(BC)" };
    opcode_table[0x0B] = (Opcode){ dec_bc, 1, 8, "DEC BC" };
    opcode_table[0x0C] = (Opcode){ inc_c, 1, 4, "INC C" };
    opcode_table[0x0D] = (Opcode){ dec_c, 1, 4, "DEC C" };
    opcode_table[0x0E] = (Opcode){ ld_c_d8, 2, 8, "LD C,d8" };
    opcode_table[0x0F] = (Opcode){ rrca, 1, 4, "RRCA" };
    opcode_table[0x11] = (Opcode){ ld_de_d16, 3, 12, "LD DE,d16" };
    opcode_table[0x12] = (Opcode){ ld_de_a, 1, 8, "LD (DE),A" };
    opcode_table[0x13] = (Opcode){ inc_de, 1, 8, "INC DE" };
    opcode_table[0x14] = (Opcode){ inc_d, 1, 4, "INC D" };
    opcode_table[0x15] = (Opcode){ dec_d, 1, 4, "DEC D" };
    opcode_table[0x16] = (Opcode){ ld_d_d8, 2, 8, "LD D,d8" };
    opcode_table[0x17] = (Opcode){ rla, 1, 4, "RLA" };
    opcode_table[0x18] = (Opcode){ jr_s8, 2, 12, "JR s8" };
    opcode_table[0x19] = (Opcode){ add_hl_de, 1, 8, "ADD HL,DE" };
    opcode_table[0x1A] = (Opcode){ ld_a_de, 1, 8, "LD A,(DE)" };
    opcode_table[0x1B] = (Opcode){ dec_de, 1, 8, "DEC DE" };
    opcode_table[0x1C] = (Opcode){ inc_e, 1, 4, "INC E" };
    opcode_table[0x1D] = (Opcode){ dec_e, 1, 4, "DEC E" };
    opcode_table[0x1E] = (Opcode){ ld_e_d8, 2, 8, "LD E,d8" };
    opcode_table[0x1F] = (Opcode){ rra, 1, 4, "RRA" };
    opcode_table[0x20] = (Opcode){ jr_nz_s8, 2, 8, "JR NZ,s8" }; 
    opcode_table[0x21] = (Opcode){ ld_hl_d16, 3, 12, "LD HL,d16" };
    opcode_table[0x22] = (Opcode){ ld_hli_a, 1, 8, "LD (HL+),A" };
    opcode_table[0x23] = (Opcode){ inc_hl, 1, 8, "INC HL" };
    opcode_table[0x24] = (Opcode){ inc_h, 1, 4, "INC H" };
    opcode_table[0x25] = (Opcode){ dec_h, 1, 4, "DEC H" };
    opcode_table[0x26] = (Opcode){ ld_h_d8, 2, 8, "LD H,d8" };
    opcode_table[0x27] = (Opcode){ daa, 1, 4, "DAA" };
    opcode_table[0x28] = (Opcode){ jr_z_s8, 2, 8, "JR Z,s8" }; 
    opcode_table[0x29] = (Opcode){ add_hl_hl, 1, 8, "ADD HL,HL" };
    opcode_table[0x2A] = (Opcode){ ld_a_hli, 1, 8, "LD A,(HL+)" };
    opcode_table[0x2B] = (Opcode){ dec_hl, 1, 8, "DEC HL" };
    opcode_table[0x2C] = (Opcode){ inc_l, 1, 4, "INC L" };
    opcode_table[0x2D] = (Opcode){ dec_l, 1, 4, "DEC L" };
    opcode_table[0x2E] = (Opcode){ ld_l_d8, 2, 8, "LD L,d8" };
    opcode_table[0x2F] = (Opcode){ cpl, 1, 4, "CPL" };
    opcode_table[0x30] = (Opcode){ jr_nc_s8, 2, 8, "JR NC,s8" }; 
    opcode_table[0x31] = (Opcode){ ld_sp_d16, 3, 12, "LD SP,d16" };
    opcode_table[0x32] = (Opcode){ ld_hld_a, 1, 8, "LD (HL-),A" };
    opcode_table[0x33] = (Opcode){ inc_sp, 1, 8, "INC SP" };
    opcode_table[0x34] = (Opcode){ inc_hlm, 1, 12, "INC (HL)" };
    opcode_table[0x35] = (Opcode){ dec_hlm, 1, 12, "DEC (HL)" };
    opcode_table[0x36] = (Opcode){ ld_hl_d8, 2, 12, "LD (HL),d8" };
    opcode_table[0x37] = (Opcode){ scf, 1, 4, "SCF" };
    opcode_table[0x38] = (Opcode){ jr_c_s8, 2, 8, "JR C,s8" }; 
    opcode_table[0x39] = (Opcode){ add_hl_sp, 1, 8, "ADD HL,SP" };
    opcode_table[0x3A] = (Opcode){ ld_a_hld, 1, 8, "LD A,(HL-)" };
    opcode_table[0x3B] = (Opcode){ dec_sp, 1, 8, "DEC SP" };
    opcode_table[0x3C] = (Opcode){ inc_a, 1, 4, "INC A" };
    opcode_table[0x3D] = (Opcode){ dec_a, 1, 4, "DEC A" };
    opcode_table[0x3E] = (Opcode){ ld_a_d8, 2, 8, "LD A,d8" };
    opcode_table[0x3F] = (Opcode){ ccf, 1, 4, "CCF" };
    opcode_table[0x40] = (Opcode){ ld_b_b, 1, 4, "LD B,B" };
    opcode_table[0x41] = (Opcode){ ld_b_c, 1, 4, "LD B,C" };
    opcode_table[0x42] = (Opcode){ ld_b_d, 1, 4, "LD B,D" };
    opcode_table[0x43] = (Opcode){ ld_b_e, 1, 4, "LD B,E" };
    opcode_table[0x44] = (Opcode){ ld_b_h, 1, 4, "LD B,H" };
    opcode_table[0x45] = (Opcode){ ld_b_l, 1, 4, "LD B,L" };
    opcode_table[0x46] = (Opcode){ ld_b_hl, 1, 8, "LD B,(HL)" };
    opcode_table[0x47] = (Opcode){ ld_b_a, 1, 4, "LD B,A" };
    opcode_table[0x48] = (Opcode){ ld_c_b, 1, 4, "LD C,B" };
    opcode_table[0x49] = (Opcode){ ld_c_c, 1, 4, "LD C,C" };
    opcode_table[0x4A] = (Opcode){ ld_c_d, 1, 4, "LD C,D" };
    opcode_table[0x4B] = (Opcode){ ld_c_e, 1, 4, "LD C,E" };
    opcode_table[0x4C] = (Opcode){ ld_c_h, 1, 4, "LD C,H" };
    opcode_table[0x4D] = (Opcode){ ld_c_l, 1, 4, "LD C,L" };
    opcode_table[0x4E] = (Opcode){ ld_c_hl, 1, 8, "LD C,(HL)" };
    opcode_table[0x4F] = (Opcode){ ld_c_a, 1, 4, "LD C,A" };
    opcode_table[0x50] = (Opcode){ ld_d_b, 1, 4, "LD D,B" };
    opcode_table[0x51] = (Opcode){ ld_d_c, 1, 4, "LD D,C" };
    opcode_table[0x52] = (Opcode){ ld_d_d, 1, 4, "LD D,D" };
    opcode_table[0x53] = (Opcode){ ld_d_e, 1, 4, "LD D,E" };
    opcode_table[0x54] = (Opcode){ ld_d_h, 1, 4, "LD D,H" };
    opcode_table[0x55] = (Opcode){ ld_d_l, 1, 4, "LD D,L" };
    opcode_table[0x56] = (Opcode){ ld_d_hl, 1, 8, "LD D,(HL)" };
    opcode_table[0x57] = (Opcode){ ld_d_a, 1, 4, "LD D,A" };
    opcode_table[0x58] = (Opcode){ ld_e_b, 1, 4, "LD E,B" };
    opcode_table[0x59] = (Opcode){ ld_e_c, 1, 4, "LD E,C" };
    opcode_table[0x5A] = (Opcode){ ld_e_d, 1, 4, "LD E,D" };
    opcode_table[0x5B] = (Opcode){ ld_e_e, 1, 4, "LD E,E" };
    opcode_table[0x5C] = (Opcode){ ld_e_h, 1, 4, "LD E,H" };
    opcode_table[0x5D] = (Opcode){ ld_e_l, 1, 4, "LD E,L" };
    opcode_table[0x5E] = (Opcode){ ld_e_hl, 1, 8, "LD E,(HL)" };
    opcode_table[0x5F] = (Opcode){ ld_e_a, 1, 4, "LD E,A" };
    opcode_table[0x60] = (Opcode){ ld_h_b, 1, 4, "LD H,B" };
    opcode_table[0x61] = (Opcode){ ld_h_c, 1, 4, "LD H,C" };
    opcode_table[0x62] = (Opcode){ ld_h_d, 1, 4, "LD H,D" };
    opcode_table[0x63] = (Opcode){ ld_h_e, 1, 4, "LD H,E" };
    opcode_table[0x64] = (Opcode){ ld_h_h, 1, 4, "LD H,H" };
    opcode_table[0x65] = (Opcode){ ld_h_l, 1, 4, "LD H,L" };
    opcode_table[0x66] = (Opcode){ ld_h_hl, 1, 8, "LD H,(HL)" };
    opcode_table[0x67] = (Opcode){ ld_h_a, 1, 4, "LD H,A" };
    opcode_table[0x68] = (Opcode){ ld_l_b, 1, 4, "LD L,B" };
    opcode_table[0x69] = (Opcode){ ld_l_c, 1, 4, "LD L,C" };
    opcode_table[0x6A] = (Opcode){ ld_l_d, 1, 4, "LD L,D" };
    opcode_table[0x6B] = (Opcode){ ld_l_e, 1, 4, "LD L,E" };
    opcode_table[0x6C] = (Opcode){ ld_l_h, 1, 4, "LD L,H" };
    opcode_table[0x6D] = (Opcode){ ld_l_l, 1, 4, "LD L,L" };
    opcode_table[0x6E] = (Opcode){ ld_l_hl, 1, 8, "LD L,(HL)" };
    opcode_table[0x6F] = (Opcode){ ld_l_a, 1, 4, "LD L,A" };
    opcode_table[0x70] = (Opcode){ ld_hl_b, 1, 8, "LD (HL),B" };
    opcode_table[0x71] = (Opcode){ ld_hl_c, 1, 8, "LD (HL),C" };
    opcode_table[0x72] = (Opcode){ ld_hl_d, 1, 8, "LD (HL),D" };
    opcode_table[0x73] = (Opcode){ ld_hl_e, 1, 8, "LD (HL),E" };
    opcode_table[0x74] = (Opcode){ ld_hl_h, 1, 8, "LD (HL),H" };
    opcode_table[0x75] = (Opcode){ ld_hl_l, 1, 8, "LD (HL),L" };
    // 0x76 HALT is skipped
    opcode_table[0x77] = (Opcode){ ld_hl_a, 1, 8, "LD (HL),A" };
    opcode_table[0x78] = (Opcode){ ld_a_b, 1, 4, "LD A,B" };
    opcode_table[0x79] = (Opcode){ ld_a_c, 1, 4, "LD A,C" };
    opcode_table[0x7A] = (Opcode){ ld_a_d, 1, 4, "LD A,D" };
    opcode_table[0x7B] = (Opcode){ ld_a_e, 1, 4, "LD A,E" };
    opcode_table[0x7C] = (Opcode){ ld_a_h, 1, 4, "LD A,H" };
    opcode_table[0x7D] = (Opcode){ ld_a_l, 1, 4, "LD A,L" };
    opcode_table[0x7E] = (Opcode){ ld_a_hl, 1, 8, "LD A,(HL)" };
    opcode_table[0x7F] = (Opcode){ ld_a_a, 1, 4, "LD A,A" };
    opcode_table[0x80] = (Opcode){ add_a_b, 1, 4, "ADD A,B" };
    opcode_table[0x81] = (Opcode){ add_a_c, 1, 4, "ADD A,C" };
    opcode_table[0x82] = (Opcode){ add_a_d, 1, 4, "ADD A,D" };
    opcode_table[0x83] = (Opcode){ add_a_e, 1, 4, "ADD A,E" };
    opcode_table[0x84] = (Opcode){ add_a_h, 1, 4, "ADD A,H" };
    opcode_table[0x85] = (Opcode){ add_a_l, 1, 4, "ADD A,L" };
    opcode_table[0x86] = (Opcode){ add_a_hl, 1, 8, "ADD A,(HL)" };
    opcode_table[0x87] = (Opcode){ add_a_a, 1, 4, "ADD A,A" };
    opcode_table[0x88] = (Opcode){ adc_a_b, 1, 4, "ADC A,B" };
    opcode_table[0x89] = (Opcode){ adc_a_c, 1, 4, "ADC A,C" };
    opcode_table[0x8A] = (Opcode){ adc_a_d, 1, 4, "ADC A,D" };
    opcode_table[0x8B] = (Opcode){ adc_a_e, 1, 4, "ADC A,E" };
    opcode_table[0x8C] = (Opcode){ adc_a_h, 1, 4, "ADC A,H" };
    opcode_table[0x8D] = (Opcode){ adc_a_l, 1, 4, "ADC A,L" };
    opcode_table[0x8E] = (Opcode){ adc_a_hl, 1, 8, "ADC A,(HL)" };
    opcode_table[0x8F] = (Opcode){ adc_a_a, 1, 4, "ADC A,A" };
    opcode_table[0x90] = (Opcode){ sub_b, 1, 4, "SUB B" };
    opcode_table[0x91] = (Opcode){ sub_c, 1, 4, "SUB C" };
    opcode_table[0x92] = (Opcode){ sub_d, 1, 4, "SUB D" };
    opcode_table[0x93] = (Opcode){ sub_e, 1, 4, "SUB E" };
    opcode_table[0x94] = (Opcode){ sub_h, 1, 4, "SUB H" };
    opcode_table[0x95] = (Opcode){ sub_l, 1, 4, "SUB L" };
    opcode_table[0x96] = (Opcode){ sub_hl, 1, 8, "SUB (HL)" };
    opcode_table[0x97] = (Opcode){ sub_a, 1, 4, "SUB A" };
    opcode_table[0x98] = (Opcode){ sbc_a_b, 1, 4, "SBC A,B" };
    opcode_table[0x99] = (Opcode){ sbc_a_c, 1, 4, "SBC A,C" };
    opcode_table[0x9A] = (Opcode){ sbc_a_d, 1, 4, "SBC A,D" };
    opcode_table[0x9B] = (Opcode){ sbc_a_e, 1, 4, "SBC A,E" };
    opcode_table[0x9C] = (Opcode){ sbc_a_h, 1, 4, "SBC A,H" };
    opcode_table[0x9D] = (Opcode){ sbc_a_l, 1, 4, "SBC A,L" };
    opcode_table[0x9E] = (Opcode){ sbc_a_hl, 1, 8, "SBC A,(HL)" };
    opcode_table[0x9F] = (Opcode){ sbc_a_a, 1, 4, "SBC A,A" };

    // 0xA0 - 0xAF (AND and XOR group)
    opcode_table[0xA0] = (Opcode){ and_b, 1, 4, "AND B" };
    opcode_table[0xA1] = (Opcode){ and_c, 1, 4, "AND C" };
    opcode_table[0xA2] = (Opcode){ and_d, 1, 4, "AND D" };
    opcode_table[0xA3] = (Opcode){ and_e, 1, 4, "AND E" };
    opcode_table[0xA4] = (Opcode){ and_h, 1, 4, "AND H" };
    opcode_table[0xA5] = (Opcode){ and_l, 1, 4, "AND L" };
    opcode_table[0xA6] = (Opcode){ and_hl, 1, 8, "AND (HL)" };
    opcode_table[0xA7] = (Opcode){ and_a, 1, 4, "AND A" };
    opcode_table[0xA8] = (Opcode){ xor_b, 1, 4, "XOR B" };
    opcode_table[0xA9] = (Opcode){ xor_c, 1, 4, "XOR C" };
    opcode_table[0xAA] = (Opcode){ xor_d, 1, 4, "XOR D" };
    opcode_table[0xAB] = (Opcode){ xor_e, 1, 4, "XOR E" };
    opcode_table[0xAC] = (Opcode){ xor_h, 1, 4, "XOR H" };
    opcode_table[0xAD] = (Opcode){ xor_l, 1, 4, "XOR L" };
    opcode_table[0xAE] = (Opcode){ xor_hl, 1, 8, "XOR (HL)" };
    opcode_table[0xAF] = (Opcode){ xor_a, 1, 4, "XOR A" };
    // 0xB0 - 0xBF (OR and CP group)
    opcode_table[0xB0] = (Opcode){ or_b, 1, 4, "OR B" };
    opcode_table[0xB1] = (Opcode){ or_c, 1, 4, "OR C" };
    opcode_table[0xB2] = (Opcode){ or_d, 1, 4, "OR D" };
    opcode_table[0xB3] = (Opcode){ or_e, 1, 4, "OR E" };
    opcode_table[0xB4] = (Opcode){ or_h, 1, 4, "OR H" };
    opcode_table[0xB5] = (Opcode){ or_l, 1, 4, "OR L" };
    opcode_table[0xB6] = (Opcode){ or_hl, 1, 8, "OR (HL)" };
    opcode_table[0xB7] = (Opcode){ or_a, 1, 4, "OR A" };
    opcode_table[0xB8] = (Opcode){ cp_b, 1, 4, "CP B" };
    opcode_table[0xB9] = (Opcode){ cp_c, 1, 4, "CP C" };
    opcode_table[0xBA] = (Opcode){ cp_d, 1, 4, "CP D" };
    opcode_table[0xBB] = (Opcode){ cp_e, 1, 4, "CP E" };
    opcode_table[0xBC] = (Opcode){ cp_h, 1, 4, "CP H" };
    opcode_table[0xBD] = (Opcode){ cp_l, 1, 4, "CP L" };
    opcode_table[0xBE] = (Opcode){ cp_hl, 1, 8, "CP (HL)" };
    opcode_table[0xBF] = (Opcode){ cp_a, 1, 4, "CP A" };
    
    opcode_table[0xC0] = (Opcode){ ret_nz, 1, 20, "RET NZ" };
    opcode_table[0xC1] = (Opcode){ pop_bc, 1, 12, "POP BC" };
    opcode_table[0xC2] = (Opcode){ jp_nz_nn, 3, 12, "JP NZ,nn" };
    opcode_table[0xC3] = (Opcode){ jp_nn, 3, 12, "JP nn" };
    opcode_table[0xC4] = (Opcode){ call_nz_nn, 3, 12, "CALL NZ,nn" };
    opcode_table[0xC5] = (Opcode){ push_bc, 1, 8, "PUSH BC" };
    opcode_table[0xC6] = (Opcode){ add_a_n, 2, 8, "ADD A,n" };
    opcode_table[0xC7] = (Opcode){ rst_00h, 1, 16, "RST 00h" };
    opcode_table[0xC8] = (Opcode){ ret_z, 1, 20, "RET Z" };
    opcode_table[0xC9] = (Opcode){ ret, 1, 16, "RET" };
    opcode_table[0xCA] = (Opcode){ jp_z_nn, 3, 12, "JP Z,nn" };
    opcode_table[0xCB] = (Opcode){ prefix_cb, 1, 4, "PREFIX CB" };
    opcode_table[0xCC] = (Opcode){ call_z_nn, 3, 12, "CALL Z,nn" };
    opcode_table[0xCD] = (Opcode){ call_nn, 3, 12, "CALL nn" };
    opcode_table[0xCE] = (Opcode){ adc_a_n, 2, 8, "ADC A,n" };
    opcode_table[0xCF] = (Opcode){ rst_08h, 1, 16, "RST 08h" };
    opcode_table[0xD0] = (Opcode){ ret_nc, 1, 20, "RET NC" };
    opcode_table[0xD1] = (Opcode){ pop_de, 1, 12, "POP DE" };
    opcode_table[0xD2] = (Opcode){ jp_nc_nn, 3, 12, "JP NC,nn" };
    opcode_table[0xD3] = (Opcode){ unused_d3, 1, 4, "D3" };
    opcode_table[0xD4] = (Opcode){ call_nc_nn, 3, 12, "CALL NC,nn" };
    opcode_table[0xD5] = (Opcode){ push_de, 1, 8, "PUSH DE" };
    opcode_table[0xD6] = (Opcode){ sub_n, 2, 8, "SUB n" };
    opcode_table[0xD7] = (Opcode){ rst_10h, 1, 16, "RST 10h" };
    opcode_table[0xD8] = (Opcode){ ret_c, 1, 20, "RET C" };
    opcode_table[0xD9] = (Opcode){ reti, 1, 16, "RETI" };
    opcode_table[0xDA] = (Opcode){ jp_c_nn, 3, 12, "JP C,nn" };
    opcode_table[0xDB] = (Opcode){ unused_db, 1, 4, "DB" };
    opcode_table[0xDC] = (Opcode){ call_c_nn, 3, 12, "CALL C,nn" };
    opcode_table[0xDD] = (Opcode){ unused_dd, 1, 4, "DD" };
    opcode_table[0xDE] = (Opcode){ sbc_a_n, 2, 8, "SBC A,n" };
    opcode_table[0xDF] = (Opcode){ rst_18h, 1, 16, "RST 18h" };
    opcode_table[0xE0] = (Opcode){ ldh_a8_a, 2, 12, "LDH (a8),A" };
    opcode_table[0xE1] = (Opcode){ pop_hl, 1, 12, "POP HL" };
    opcode_table[0xE2] = (Opcode){ ld__c_a, 1, 8, "LD (C),A" };
    // opcode_table[0xE3] = (Opcode){ unused_e3, 1, 4, "E3" };
    // opcode_table[0xE4] = (Opcode){ unused_e4, 1, 4, "E4" };
    opcode_table[0xE5] = (Opcode){ push_hl, 1, 8, "PUSH HL" };
    opcode_table[0xE6] = (Opcode){ and_n, 2, 8, "AND n" };
    opcode_table[0xE7] = (Opcode){ rst_20h, 1, 16, "RST 20h" };
    opcode_table[0xE8] = (Opcode){ add_sp_s8, 2, 16, "ADD SP,s8" };
    opcode_table[0xE9] = (Opcode){ jp_hl, 1, 4, "JP HL" };
    opcode_table[0xEA] = (Opcode){ ld_a16_a, 3, 16, "LD A,(a16)" };
    // opcode_table[0xEB] = (Opcode){ unused_eb, 1, 4, "EB" };
    // opcode_table[0xEC] = (Opcode){ unused_ec, 1, 4, "EC" };
    // opcode_table[0xED] = (Opcode){ unused_ed, 1, 4, "ED" };
    opcode_table[0xEE] = (Opcode){ xor_n, 2, 8, "XOR n" };
    opcode_table[0xEF] = (Opcode){ rst_28h, 1, 16, "RST 28h" };
    opcode_table[0xF0] = (Opcode){ ldh_a_a8, 2, 12, "LDH A,(a8)" };
    opcode_table[0xF1] = (Opcode){ pop_af, 1, 12, "POP AF" };
    opcode_table[0xF2] = (Opcode){ ld_a__c, 1, 8, "LD A,(C)" };
    opcode_table[0xF3] = (Opcode){ di, 1, 4, "DI" };
    // opcode_table[0xF4] = (Opcode){ unused_f4, 1, 4, "F4" };
    opcode_table[0xF5] = (Opcode){ push_af, 1, 8, "PUSH AF" };
    opcode_table[0xF6] = (Opcode){ or_n, 2, 8, "OR n" };
    opcode_table[0xF7] = (Opcode){ rst_30h, 1, 16, "RST 30h" };
    // opcode_table[0xF8] = (Opcode){ ld_hl_sp_s8, 2, 12, "LD HL,SP+s8" };
    opcode_table[0xF9] = (Opcode){ ld_sp_hl, 1, 4, "LD SP,HL" };
    opcode_table[0xFA] = (Opcode){ ld_a_a16, 3, 16, "LD A,(a16)" };
    opcode_table[0xFB] = (Opcode){ ei, 1, 4, "EI" };
    // opcode_table[0xFC] = (Opcode){ unused_fc, 1, 4, "FC" };
    // opcode_table[0xFD] = (Opcode){ unused_fd, 1, 4, "FD" };
    opcode_table[0xFE] = (Opcode){ cp_n, 2, 8, "CP n" };
    opcode_table[0xFF] = (Opcode){ rst_38h, 1, 16, "RST 38h" };
}

